BEGIN TRANSACTION;
DROP TABLE IF EXISTS ITENS_NFS;
CREATE TABLE ITENS_NFS (
    id_itens_nf INTEGER PRIMARY KEY AUTOINCREMENT,
    cod_itens_nf INT NOT NULL,
    sequencia_itens_nf INT NOT NULL,
    cod_produto INT NOT NULL,
    valor_produto REAL,
    valor_total_produto REAL,
    quantidade_itens_nf INT NOT NULL,
    FOREIGN KEY(valor_produto) REFERENCES PRODUTOS(valor_produto)
);
INSERT INTO ITENS_NFS (
        cod_itens_nf,
        sequencia_itens_nf,
        cod_produto,
        quantidade_itens_nf
    )
VALUES(1, 1, 121, 1),
    (1, 2, 114, 2),
    (1, 3, 198, 1),
    (1, 4, 90, 5),
    (1, 5, 86, 1),
    (1, 6, 37, 1),
    (1, 7, 38, 5),
    (1, 8, 116, 2),
    (1, 9, 37, 3),
    (1, 10, 107, 3),
    (1, 11, 103, 5),
    (1, 12, 13, 4),
    (1, 13, 17, 3),
    (2, 1, 58, 4),
    (2, 2, 186, 1),
    (2, 3, 79, 3),
    (2, 4, 135, 4),
    (2, 5, 168, 5),
    (2, 6, 79, 5),
    (2, 7, 164, 5),
    (2, 8, 2, 2),
    (2, 9, 80, 5),
    (3, 1, 117, 1),
    (3, 2, 96, 4),
    (3, 3, 143, 1),
    (3, 4, 111, 3),
    (3, 5, 155, 2),
    (3, 6, 68, 2),
    (3, 7, 196, 5),
    (3, 8, 6, 3),
    (3, 9, 25, 4),
    (3, 10, 56, 4),
    (3, 11, 28, 5),
    (4, 1, 92, 5),
    (4, 2, 26, 4),
    (4, 3, 31, 5),
    (4, 4, 56, 2),
    (4, 5, 94, 4),
    (4, 6, 47, 5),
    (4, 7, 77, 1),
    (4, 8, 35, 1),
    (4, 9, 23, 2),
    (4, 10, 158, 3),
    (5, 1, 58, 1),
    (5, 2, 132, 5),
    (5, 3, 145, 5),
    (5, 4, 67, 3),
    (5, 5, 52, 4),
    (5, 6, 189, 2),
    (5, 7, 165, 3),
    (5, 8, 198, 1),
    (5, 9, 53, 3),
    (5, 10, 190, 3),
    (5, 11, 110, 2),
    (5, 12, 139, 3),
    (6, 1, 117, 2),
    (6, 2, 82, 4),
    (6, 3, 16, 5),
    (6, 4, 60, 4),
    (6, 5, 62, 2),
    (6, 6, 101, 7),
    (6, 7, 141, 9),
    (7, 1, 161, 4),
    (7, 2, 23, 2),
    (7, 3, 102, 1),
    (7, 4, 151, 1),
    (7, 5, 85, 4),
    (7, 6, 33, 4),
    (7, 7, 102, 4),
    (7, 8, 112, 5),
    (7, 9, 17, 1),
    (7, 10, 200, 1),
    (7, 11, 22, 2),
    (7, 12, 152, 4),
    (7, 13, 9, 2),
    (7, 14, 15, 5),
    (7, 15, 88, 2),
    (8, 1, 126, 4),
    (8, 2, 118, 3),
    (8, 3, 121, 2),
    (8, 4, 168, 3),
    (8, 5, 100, 5),
    (8, 6, 149, 1),
    (8, 7, 117, 1),
    (8, 8, 126, 1),
    (8, 9, 141, 2),
    (8, 10, 160, 4),
    (8, 11, 138, 2),
    (9, 1, 175, 1),
    (9, 2, 149, 1),
    (9, 3, 121, 1),
    (9, 4, 19, 2),
    (9, 5, 100, 1),
    (9, 6, 178, 5),
    (9, 7, 127, 5),
    (9, 8, 119, 2),
    (9, 9, 113, 5),
    (9, 10, 1, 5),
    (9, 11, 30, 4),
    (9, 12, 68, 3),
    (9, 13, 127, 4),
    (9, 14, 36, 3),
    (10, 1, 192, 1),
    (10, 2, 143, 5),
    (10, 3, 9, 1),
    (10, 4, 73, 2),
    (10, 5, 189, 5),
    (10, 6, 135, 5),
    (10, 7, 69, 4),
    (10, 8, 108, 1),
    (10, 9, 35, 2),
    (10, 10, 166, 3),
    (10, 11, 127, 5),
    (10, 12, 142, 1),
    (10, 13, 45, 5),
    (10, 14, 109, 3),
    (11, 1, 139, 1),
    (11, 2, 97, 2),
    (11, 3, 74, 2),
    (11, 4, 11, 3),
    (11, 5, 49, 4),
    (11, 6, 127, 3),
    (11, 7, 178, 5),
    (11, 8, 83, 3),
    (11, 9, 117, 2),
    (11, 10, 133, 1),
    (11, 11, 71, 4),
    (11, 12, 15, 4),
    (11, 13, 160, 2),
    (12, 1, 52, 5),
    (12, 2, 92, 3),
    (12, 3, 157, 4),
    (12, 4, 116, 3),
    (12, 5, 166, 2),
    (12, 6, 42, 3),
    (12, 7, 42, 2),
    (12, 8, 189, 3),
    (12, 9, 57, 4),
    (13, 1, 125, 1),
    (13, 2, 185, 5),
    (13, 3, 93, 1),
    (13, 4, 168, 4),
    (13, 5, 142, 5),
    (13, 6, 9, 2),
    (13, 7, 6, 1),
    (13, 8, 119, 4),
    (13, 9, 13, 5),
    (13, 10, 198, 1),
    (13, 11, 11, 5),
    (14, 1, 196, 4),
    (14, 2, 49, 2),
    (14, 3, 113, 4),
    (14, 4, 48, 5),
    (14, 5, 149, 5),
    (14, 6, 5, 4),
    (14, 7, 39, 2),
    (14, 8, 82, 1),
    (14, 9, 41, 3),
    (14, 10, 126, 3),
    (15, 1, 95, 1),
    (15, 2, 136, 5),
    (15, 3, 149, 4),
    (15, 4, 144, 1),
    (15, 5, 84, 5),
    (15, 6, 30, 2),
    (15, 7, 127, 2),
    (15, 8, 56, 4),
    (15, 9, 55, 1),
    (15, 10, 31, 3),
    (15, 11, 101, 2),
    (15, 12, 125, 4),
    (16, 1, 159, 2),
    (16, 2, 138, 4),
    (16, 3, 79, 2),
    (16, 4, 97, 3),
    (16, 5, 75, 3),
    (16, 6, 111, 5),
    (16, 7, 31, 4),
    (17, 1, 6, 3),
    (17, 2, 164, 3),
    (17, 3, 163, 1),
    (17, 4, 174, 4),
    (17, 5, 107, 1),
    (17, 6, 76, 3),
    (17, 7, 123, 2),
    (17, 8, 170, 1),
    (17, 9, 168, 1),
    (17, 10, 57, 2),
    (17, 11, 101, 4),
    (17, 12, 125, 4),
    (17, 13, 140, 5),
    (17, 14, 30, 3),
    (17, 15, 122, 2),
    (18, 1, 147, 3),
    (18, 2, 176, 4),
    (18, 3, 98, 2),
    (18, 4, 99, 4),
    (18, 5, 195, 1),
    (18, 6, 94, 2),
    (18, 7, 47, 1),
    (18, 8, 77, 1),
    (18, 9, 35, 3),
    (18, 10, 23, 2),
    (18, 11, 158, 1),
    (19, 1, 58, 5),
    (19, 2, 132, 1),
    (19, 3, 145, 1),
    (19, 4, 67, 5),
    (19, 5, 52, 2),
    (19, 6, 189, 3),
    (19, 7, 165, 3),
    (19, 8, 198, 5),
    (19, 9, 53, 4),
    (19, 10, 190, 3),
    (19, 11, 110, 4),
    (19, 12, 139, 1),
    (19, 13, 117, 3),
    (19, 14, 82, 4),
    (20, 1, 16, 5),
    (20, 2, 60, 5),
    (20, 3, 62, 5),
    (20, 4, 101, 2),
    (20, 5, 141, 5),
    (20, 6, 161, 1),
    (20, 7, 23, 4),
    (20, 8, 102, 1),
    (20, 9, 151, 3),
    (20, 10, 85, 2),
    (20, 11, 33, 2),
    (20, 12, 102, 5),
    (20, 13, 112, 3),
    (20, 14, 17, 4),
    (21, 1, 200, 4),
    (21, 2, 22, 5),
    (21, 3, 152, 5),
    (21, 4, 9, 4),
    (21, 5, 15, 5),
    (21, 6, 88, 2),
    (21, 7, 126, 4),
    (21, 8, 118, 5),
    (21, 9, 121, 1),
    (21, 10, 168, 1),
    (21, 11, 100, 2),
    (21, 12, 149, 3),
    (21, 13, 117, 1),
    (22, 1, 126, 5),
    (22, 2, 141, 5),
    (22, 3, 160, 3),
    (22, 4, 138, 4),
    (22, 5, 175, 2),
    (22, 6, 149, 3),
    (22, 7, 121, 1),
    (22, 8, 19, 3),
    (22, 9, 100, 3),
    (23, 1, 178, 2),
    (23, 2, 127, 3),
    (23, 3, 119, 2),
    (23, 4, 113, 4),
    (23, 5, 1, 5),
    (23, 6, 30, 4),
    (23, 7, 68, 2),
    (23, 8, 127, 7),
    (23, 9, 36, 9),
    (23, 10, 192, 4),
    (23, 11, 143, 2),
    (24, 1, 9, 1),
    (24, 2, 73, 1),
    (24, 3, 189, 4),
    (24, 4, 135, 4),
    (24, 5, 69, 4),
    (24, 6, 108, 5),
    (24, 7, 35, 1),
    (24, 8, 166, 1),
    (24, 9, 127, 2),
    (24, 10, 142, 4),
    (25, 1, 45, 2),
    (25, 2, 109, 5),
    (25, 3, 139, 2),
    (25, 4, 97, 4),
    (25, 5, 74, 3),
    (25, 6, 11, 2),
    (25, 7, 49, 3),
    (25, 8, 127, 5),
    (25, 9, 178, 1),
    (25, 10, 83, 1),
    (25, 11, 117, 1),
    (25, 12, 133, 2),
    (26, 1, 71, 4),
    (26, 2, 15, 2),
    (26, 3, 160, 1),
    (26, 4, 52, 1),
    (26, 5, 92, 1),
    (26, 6, 157, 2),
    (26, 7, 116, 1),
    (27, 1, 166, 5),
    (27, 2, 42, 5),
    (27, 3, 42, 2),
    (27, 4, 189, 5),
    (27, 5, 57, 5),
    (27, 6, 125, 4),
    (27, 7, 185, 3),
    (27, 8, 93, 4),
    (27, 9, 168, 3),
    (27, 10, 142, 1),
    (27, 11, 9, 5),
    (27, 12, 6, 1),
    (27, 13, 119, 2),
    (27, 14, 13, 5),
    (27, 15, 198, 5),
    (28, 1, 11, 4),
    (28, 2, 196, 1),
    (28, 3, 49, 2),
    (28, 4, 113, 3),
    (28, 5, 48, 5),
    (28, 6, 149, 1),
    (28, 7, 5, 5),
    (28, 8, 39, 3),
    (28, 9, 82, 1),
    (28, 10, 41, 2),
    (28, 11, 126, 2),
    (29, 1, 95, 3),
    (29, 2, 136, 4),
    (29, 3, 149, 3),
    (29, 4, 144, 5),
    (29, 5, 117, 3),
    (29, 6, 133, 2),
    (29, 7, 71, 1),
    (29, 8, 15, 4),
    (29, 9, 160, 4),
    (29, 10, 52, 2),
    (29, 11, 92, 5),
    (29, 12, 157, 3),
    (29, 13, 116, 4),
    (29, 14, 166, 3),
    (30, 1, 42, 2),
    (30, 2, 42, 3),
    (30, 3, 189, 2),
    (30, 4, 57, 3),
    (30, 5, 125, 4),
    (30, 6, 185, 1),
    (30, 7, 93, 5),
    (30, 8, 168, 1),
    (30, 9, 142, 4),
    (30, 10, 9, 5),
    (30, 11, 6, 2),
    (30, 12, 119, 1),
    (30, 13, 13, 4),
    (30, 14, 198, 5);
UPDATE ITENS_NFS
SET valor_produto = (
        SELECT PRODUTOS.valor_produto
        FROM PRODUTOS
        WHERE PRODUTOS.codigo_produto = ITENS_NFS.cod_produto
    );
UPDATE ITENS_NFS
SET valor_total_produto = (
     valor_produto * quantidade_itens_nf)
;
COMMIT;
SELECT *
FROM ITENS_NFS;